# ホテル予約システム設計書の説明
こちらのシステムはLaravel・React・Docker学習のために作成する為の架空のホテルの予約システムです。
以下に情報を記載しております。

# 全体設計・仕様概要

## システム概要　　
本システムは、Reactを用いたフロントエンドと、Laravelを用いたバックエンドAPIで構成されるSPA（シングルページアプリケーション）型のホテル予約サービスです。
データベースにはMySQLを採用し、開発環境はDockerとdocker-composeを活用して、フロントエンド・バックエンド・データベースをそれぞれ独立したコンテナで管理しています。
多言語対応、複数の決済方法、管理者の予約管理機能、詳細な操作ログとエラーログ管理といった高度な機能を備えています。

## 技術スタック　　
フロントエンドは、Reactを使用し、ユーザーインターフェースの構築にBootstrapを活用しています。また、多言語対応のためreact-i18nextを導入し、使いやすいUIを実現しています。
バックエンドはLaravelでRESTful APIを実装し、API認証にはセキュアな仕組みを整えています。データベースはMySQLを利用し、これらの各サービスをDockerコンテナ内で動作させ、環境の一貫性と開発効率を高めています。
決済機能にはStripeのテストモードを利用し、また現金支払いにも対応しています。

# 主な機能と仕様　　
## 1. ユーザー管理　　
ユーザー登録時の入力項目は名前、電話番号、メールアドレス、年齢、性別、パスワードおよびパスワードの確認です。
ログイン時には名前、メールアドレス、パスワードを必須とし、セキュリティ強化の一環として名前も認証条件に加えています。
画面は多言語対応を行い、日本語・英語の切り替えが可能です。

## 2. 管理者機能　　
管理者の新規登録では名前、5桁の社員番号、メールアドレス、性別、パスワードおよび確認用パスワードを入力します。
管理者のログインは社員番号、メールアドレス、パスワードで行います。
管理者専用のダッシュボードを備え、予約の一覧閲覧、検索、変更、削除が可能です。
ユーザー一覧管理やアクセス権限の厳格な制御により、運用面での安全性を確保しています。

## 3. ホテルおよび部屋管理　　
合計50部屋の部屋があり、部屋のランクは「梅」「竹」「松」の3種類です。
「梅」ランクは35部屋、1泊5,000円、「竹」は10部屋1泊10,000円、「松」は5部屋1泊15,000円です。
roomsテーブルで部屋のランクと料金を管理しています。

## 4. 予約管理　　
チェックイン時間は当日15時以降、チェックアウトは翌朝10時としています。
予約可能な部屋の残数が10部屋以下の際は「△」マークを表示し、残り部屋数が少ない旨の案内文をユーザーに提示します。
重複予約や空室競合を防止するため、API側のトランザクション処理やロック機構を導入しています。
ユーザーは自分の予約履歴の確認やキャンセルが可能です。

## 5. 決済機能　　
支払い方法として「現金払い（現地払い）」と「カード決済（Stripeテストモード）」を提供しています。
予約完了後の決済方法の変更は、ユーザー本人のみが操作可能です。
決済方法の変更履歴は操作ログに詳細に記録し、トラブル対応や監査に役立てています。
管理者はセキュリティ上の理由から決済方法の直接変更は行えません。

## 6. 多言語対応　　
フロントエンドではreact-i18nextを用いて、日本語および英語への動的切替を実装しています。
バックエンドでもAPIレスポンスやエラーメッセージをリクエストに応じて多言語化し、国際的な利用を想定しています。

## 7. 操作ログとエラーログ管理　　
操作ログは、管理者・ユーザー双方の操作履歴を一括で管理可能なテーブルに保存しています。
カテゴリー（login、booking、admin_actionなど）、操作名、詳細説明を記録し、不正対策および監査に活用しています。
エラーログには発生した例外情報やスタックトレースを保存し、迅速な問題解析を可能にしています。

# データベース設計概要　　
主要テーブルは以下の通りです。

## users　　
ユーザー情報（名前、電話番号、メールアドレス、年齢、性別、パスワードハッシュ、役割など）を管理します。

## admins　　
管理者情報（名前、社員番号、メールアドレス、性別、パスワードハッシュ等）を管理します。

## rooms　　
部屋番号、ホテルID、ランク、料金、説明を管理します。

## bookings　　
予約情報（ユーザーID、部屋ID、チェックイン日、宿泊数、予約ステータス等）を管理します。

## payments　　
決済情報（予約ID、決済方法、決済ステータス、変更日時、変更履歴等）を管理します。

## operation_logs　　
操作種別や対象テーブル、操作詳細を含む操作履歴を記録します。

## error_logs　　
エラーの内容や発生した環境情報を記録し、迅速なトラブルシューティングを支援します。

# API設計　　
一般ユーザー向けAPIとして登録、ログイン、部屋情報取得、予約管理、決済処理のエンドポイントを用意しています。
管理者向けAPIではログイン、予約一覧閲覧、予約の変更・削除、ユーザー管理などの機能を提供します。
APIの認証は、安全なトークン管理を実現する仕組みを導入し、適切なアクセス制御を行っています。
CORS設定により、ReactフロントエンドとバックエンドAPIの安全な連携を確保しています。

# 開発環境構築　　
プロジェクトはfrontend/（React）、backend/（Laravel）、docker-compose.ymlの3つの主要ディレクトリ・ファイルで構成しています。
Docker Composeにより、MySQLデータベース、Spring Bootアプリケーション、React開発サーバーを別々のコンテナで立ち上げます。
環境依存を排除し、チーム間での環境差異を防止するとともに、素早い立ち上げとスムーズなCI/CDを実現しています。

# セキュリティ・運用上の注意点　　
パスワードは必ずハッシュ化して保存し、強力なバリデーションを設けます。
認証時の必須情報としてメールアドレスに加え名前も求め、セキュリティを強化しています。
管理者と一般ユーザーの権限や認証ロジックは明確に分離し、管理画面の不正アクセス防止を徹底しています。
決済情報、特にカード番号や認証データはバックエンドで一切保持せず、決済代行サービスに委ねています。
操作ログやエラーログは個人情報を含まない範囲で詳細に収集し、不正検知やトラブル対応に役立てます。

# ユーザーインターフェースとUX　　
Bootstrapを活用し、レスポンシブで使いやすいデザインをフロントエンドに採用しています。
空室表示や残り部屋数に応じたステータス（○、△、×）の視覚的表示でユーザーにわかりやすい案内をします。
多言語対応により、グローバルユーザーへの対応も容易です。
管理者画面は予約管理や操作ログ閲覧が効率的にできる設計で、管理負荷の軽減を図っています。

# まとめ　　
本ホテル予約システムは、モダンなWeb技術と堅牢な設計方針に基づいて構築されており、ユーザーと管理者双方の使い勝手と安全性を両立しています。
Dockerを用いた開発環境の統一、充実した操作・エラーログの整備、多言語・多決済対応など、実用を見据えた柔軟なシステム設計となっています。

今後も拡張性を考慮しつつ、実装・運用の段階で必要に応じてさらなるブラッシュアップを行っていきます。
不明点やご要望があればお気軽にご相談ください。
